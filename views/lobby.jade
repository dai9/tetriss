extends layout

block content
  table.options-container
    tbody
      tr
        td.create-pointer &rarr;
        td
          a(href="/versus/") Create Game
      tr
        td.join-pointer
        td
          a(href="/versus") Join Game
      tr
        td.back-pointer
        td
          a(href="/") Back
  div.join-form
    form
      label.key-label Enter a room key:
      input.key-input(type="text")
      button.cancel-btn(type="button") Cancel
      button.join-btn(type="submit") Join
  script.
    $("body").on("keydown", function(e) {
      if (e.which === 38) {
        if ($(".join-pointer").text() === "→") {
          $(".create-pointer").text("→");
          $(".join-pointer").text("");
        } else if ($(".back-pointer").text() === "→") {
          $(".join-pointer").text("→");
          $(".back-pointer").text("");
        }
      } else if (e.which === 40) {
        if ($(".create-pointer").text() === "→") {
          $(".create-pointer").text("");
          $(".join-pointer").text("→");
        } else if ($(".join-pointer").text() === "→") {
          $(".join-pointer").text("");
          $(".back-pointer").text("→");
        }
      } else if (e.which === 13) {
        if ($(".create-pointer").text() === "→") {
          var newRoom = createKey();
          window.location.pathname = "/versus/" + newRoom;
        } else if ($(".join-pointer").text() === "→") {
          $(".join-form").css("display", "block");
        } else {
          window.location.href = "/";
        }
      } else if (e.which === 27) {
        if ($(".join-form").css("display") === "block") {
          $(".join-form").css("display", "none");
        } else {
          window.location.href = "/";
        }
      }
    });
    
    $(".join-btn").on("click", function(e) {
      e.preventDefault();
      window.location.pathname = "/versus/" + $(".key-input").val();
    });
    
    $(".cancel-btn").on("click", function() {
      $(".join-form").css("display", "none");
    })

    function createKey() {
      const KEY_LENGTH = 10;
    	var key = "";
      var chars = "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";
      for (var i = 0; i < KEY_LENGTH; i++) {
      	key += chars[Math.floor(Math.random() * chars.length)];
      }
      return key;
    }
